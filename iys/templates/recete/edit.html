{% extends 'layouts/base.html' %}
{% load static %}

{% block content %}

<style>
#id_uygulamaSaati {
    list-style-type: none;
    columns: 3;
  -webkit-columns: 3;
  -moz-columns: 3;
}

</style>

<div class="x_content">
   
    {% if form.errors %}
    {% for field in form %}
        {% for error in field.errors %}
            <div class="alert alert-danger">
                <strong>{{ error|escape }}</strong>
            </div>
        {% endfor %}
    {% endfor %}
    {% for error in form.non_field_errors %}
        <div class="alert alert-danger">
            <strong>{{ error|escape }}</strong>
        </div>
    {% endfor %}
{% endif %}
<form id="demo-form2" action="" method="post" style="margin-top:50px" class="form-horizontal form-label-left">
        {% csrf_token %}

        <div  class="col-md-12 col-sm-12 " >

            <div class="col-md-5 col-sm-5 ">

                <div class="x_panel">

                    <div class="x_title">
                            <h2>Reçete Bilgileri</h2>
                            <div class="clearfix"></div>
                    </div>
                    <div class="x_content">
                        <div class="item form-group">
                            <label class="col-form-label col-md-3 col-sm-3 label-align" for="first-name">Hasta </span>
                            </label>
                            <div class="col-md-6 col-sm-6 ">
                            {{form.hasta}}
                            </div>
                        </div>
                
                        <div class="item form-group">
                            <label class="col-form-label col-md-3 col-sm-3 label-align" for="first-name">Reçete Tarihi </span>
                            </label>
                            <div class="col-md-6 col-sm-6 ">
                            {{form.receteTarihi}}
                            </div>
                        </div>
                
                        <div class="item form-group">
                            <label class="col-form-label col-md-3 col-sm-3 label-align" for="first-name">İlaç </span>
                            </label>
                            <div class="col-md-6 col-sm-6 ">
                            {{form.ilac}}
                            </div>
                        </div>
                
                
                        <div class="item form-group">
                            <label class="col-form-label col-md-3 col-sm-3 label-align" for="first-name">Mayi </span>
                            </label>
                            <div class="col-md-6 col-sm-6 ">
                            {{form.mayi}}
                            </div>
                            <p>{{ form.mayi.errors }}</p>
                        </div>
                
                        <div class="item form-group">
                            <label class="col-form-label col-md-3 col-sm-3 label-align" for="first-name">İstenen Miktar </span>
                            </label>
                            <div class="col-md-6 col-sm-6 ">
                            {{form.istenenMiktar}}
                            </div>
                        </div>
                
                        <div class="item form-group">
                            <label class="col-form-label col-md-3 col-sm-3 label-align" for="first-name">Birimi </span>
                            </label>
                            <div class="col-md-6 col-sm-6 ">
                            {{form.birimTipi}}
                            </div>
                        </div>

                        <div class="item form-group">
                            <label class="col-form-label col-md-3 col-sm-3 label-align" for="first-name">Hemşire Notu </span>
                            </label>
                            <div class="col-md-6 col-sm-6 ">
                            {{form.hemsireNotu}}
                            </div>
                        </div>
                
                        <!-- <div class="item form-group">
                            <label class="col-form-label col-md-3 col-sm-3 label-align" for="first-name">Süre </span>
                            </label>
                            <div class="col-md-6 col-sm-6 ">
                            {{form.sure}}
                            </div>
                        </div>
                
                        <div class="item form-group">
                            <label class="col-form-label col-md-3 col-sm-3 label-align" for="first-name">Süre Tipi </span>
                            </label>
                            <div class="col-md-6 col-sm-6 ">
                            {{form.sureTipi}}
                            </div>
                        </div> -->
                    </div>
                </div>
        
            </div>

            <div class="col-md-7 col-sm-7 ">
                <div class="x_panel">
                    <div class="x_title">
                                <h2>Uygulama Bilgileri</h2>
                                <div class="clearfix"></div>
                    </div>
                    <div class="x_content">
                        <div class="item form-group">
                            <label class="col-form-label col-md-3 col-sm-3 label-align" for="first-name">Uygulama Yolu</span>
                            </label>
                            <div class="col-md-6 col-sm-6 ">
                            {{form.uygulamaYolu}}
                            </div>
                        </div>
                        <div class="item form-group">
                            <label class="col-form-label col-md-3 col-sm-3 label-align" for="first-name">Uygulama Saatleri</span>
                            </label>
                            <div class="col-md-6 col-sm-6 ">
                                    <ul id="id_uygulamaSaati">
                            {% for field in form.uygulamaSaati %}
                              
                                   <li>
                                        {{ field.tag }}  <!-- Generates the checkbox for the field -->
                                        {{ field.choice_label|time:"H:i" }}
                                   </li>
                               

                            {% endfor %}
                            </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>

       
        

     <table class="table" style="width:50%;display: none;"> 

                {{ receteuygulamas.management_form }}

                {% for form in receteuygulamas.forms %}
                    {% if forloop.first %}
                        <thead>
                        <tr>
                            {% for field in form.visible_fields %}
                                <th>{{ field.label|capfirst }}</th>
                            {% endfor %}
                        </tr>
                        </thead>
                    {% endif %}
                    <tr class="{% cycle row1 row2 %} formset_row">
                        {% for field in form.visible_fields %}
                            <td>
                                {# Include the hidden fields in the form #}
                                {% if forloop.first %}
                                    {% for hidden in form.hidden_fields %}
                                        {{ hidden }}
                                    {% endfor %}
                                {% endif %}
                                {{ field.errors.as_ul }}
                                {{ field }}
                            </td>
                        {% endfor %}
                    </tr>
                {% endfor %}

        </table>

        <input class="btn btn-success" type="submit" value="    KAYDET    "/> <a class="btn btn-primary" href="{% url 'recete:recete-list' %}">Reçete listesine dön</a>
</form>
</div>
<script type="text/javascript" src="{% static 'base/vendors/jquery/dist/jquery.min.js' %}"></script>

{{ form.media }}

<div id="dialog-confirm" title="Tedavi Durumu">
        <p><span class="ui-icon ui-icon-alert" style="float:left; margin:12px 12px 20px 0;"></span>Bu hasta için yeni tedavi bilgisi girmek istiyor musunuz ? </p>
</div>

{% endblock content %}


{% block js %}
<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<script  type="text/javascript">
$('.date-picker').datetimepicker({
    format: 'DD/MM/YYYY'
});

$( function() {

    var isUpdate = '{{isUpdate}}';
    var pk = '{{pk}}';
    var isCreate = '{{isCreate}}'
   

    if (isCreate) {
        if (isCreate == 1) {
            if (isUpdate == 'True') {
                isUpdate = true
            } else {
                isUpdate = false
            }
        } else {
            isUpdate = false
        }
    } else {
        isUpdate = false
    }

 

    $( "#dialog-confirm" ).dialog({
      resizable: false,
      height: "auto",
      width: 400,
      modal: true,
      autoOpen: isUpdate,
      buttons: {
        "Bu Hasta İçin Devam Et": function() {
            var rurl = "{% url 'recete:recete-add' hpk=1123 %}"
            location.href = rurl.replace("1123", pk);
        },
        "Yeni Hasta İçin Oluştur": function() {
            location.href = "{% url 'recete:recete-add' hpk=0 %}";
          $( this ).dialog( "close" );
        }
      }
    });
  } );

</script>

{% endblock js %}